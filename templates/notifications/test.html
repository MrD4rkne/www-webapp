{% extends 'base.html' %}

{% block title %}Test SSE Notifications{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>Test SSE Notifications</h1>
    
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h3>Generate Test Events</h3>
                </div>
                <div class="card-body">
                    <form method="post" action="{% url 'notifications:trigger_test_event' %}">
                        {% csrf_token %}
                        
                        <div class="mb-3">
                            <label for="event_type" class="form-label">Event Type</label>
                            <select class="form-select" id="event_type" name="event_type">
                                <option value="newBoard">New Board</option>
                                <option value="newPath">New Path (Solution)</option>
                            </select>
                        </div>
                        
                        <div id="board-fields">
                            <div class="mb-3">
                                <label for="board_name" class="form-label">Board Name</label>
                                <input type="text" class="form-control" id="board_name" name="board_name" value="Test Board">
                            </div>
                            
                            <div class="mb-3">
                                <label for="creator_username" class="form-label">Creator Username</label>
                                <input type="text" class="form-control" id="creator_username" name="creator_username" value="TestUser">
                            </div>
                        </div>
                        
                        <div id="path-fields" style="display: none;">
                            <div class="mb-3">
                                <label for="board_id" class="form-label">Board ID</label>
                                <input type="text" class="form-control" id="board_id" name="board_id" value="123">
                            </div>
                            
                            <div class="mb-3">
                                <label for="path_board_name" class="form-label">Board Name</label>
                                <input type="text" class="form-control" id="path_board_name" name="path_board_name" value="Test Board">
                            </div>
                            
                            <div class="mb-3">
                                <label for="user_username" class="form-label">User Username</label>
                                <input type="text" class="form-control" id="user_username" name="user_username" value="PathCreator">
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Send Test Event</button>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h3>Instructions</h3>
                </div>
                <div class="card-body">
                    <p>This page allows you to manually trigger SSE events for testing purposes.</p>
                    <ol>
                        <li>Select the event type you want to generate</li>
                        <li>Fill out the required fields</li>
                        <li>Click "Send Test Event"</li>
                        <li>View the real-time notification on the <a href="{% url 'notifications:sse_demo' %}" target="_blank">SSE Demo Page</a></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const eventTypeSelect = document.getElementById('event_type');
        const boardFields = document.getElementById('board-fields');
        const pathFields = document.getElementById('path-fields');
        
        eventTypeSelect.addEventListener('change', function() {
            if (this.value === 'newBoard') {
                boardFields.style.display = 'block';
                pathFields.style.display = 'none';
            } else {
                boardFields.style.display = 'none';
                pathFields.style.display = 'block';
            }
        });
    });
</script>
{% endblock %}
